import { OsvVulnProvider } from "./OsvVulnProvider";
import { SonatypeOSSVulnProvider } from "./SonatypeOSSVulnProvider";

export const VulnFetcherHandler = async (
  purlList: string[],
  type = "Sonatype"
) => {
  if (type == "Sonatype") {
    const OSS = new SonatypeOSSVulnProvider();
    const res = await OSS.fetchInfo(purlList);
    return res;
  }

  if (type == "OSV") {
    const Osv = new OsvVulnProvider();
    const res = await Osv.fetchInfo(purlList);
    return res;
  }
};
